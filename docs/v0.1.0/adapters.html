<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Adapters · Daf.jl v0.1.0</title><meta name="title" content="Adapters · Daf.jl v0.1.0"/><meta property="og:title" content="Adapters · Daf.jl v0.1.0"/><meta property="twitter:title" content="Adapters · Daf.jl v0.1.0"/><meta name="description" content="Documentation for Daf.jl v0.1.0."/><meta property="og:description" content="Documentation for Daf.jl v0.1.0."/><meta property="twitter:description" content="Documentation for Daf.jl v0.1.0."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.svg" alt="Daf.jl v0.1.0 logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Daf.jl v0.1.0</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Daf</a></li><li><a class="tocitem" href="data.html">Data</a></li><li><a class="tocitem" href="read_only.html">Read-only</a></li><li><a class="tocitem" href="queries.html">Queries</a></li><li><a class="tocitem" href="tokens.html">Tokens</a></li><li><a class="tocitem" href="views.html">Views</a></li><li><a class="tocitem" href="chains.html">Chains</a></li><li><a class="tocitem" href="computations.html">Computations</a></li><li><a class="tocitem" href="copies.html">Copies</a></li><li class="is-active"><a class="tocitem" href="adapters.html">Adapters</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="contracts.html">Contracts</a></li><li><a class="tocitem" href="formats.html">Formats</a></li><li><a class="tocitem" href="memory_format.html">Memory Format</a></li><li><a class="tocitem" href="h5df_format.html">H5DF Format</a></li><li><a class="tocitem" href="registry.html">Operations registry</a></li><li><a class="tocitem" href="operations.html">Query operations</a></li><li><a class="tocitem" href="storage_types.html">Storage types</a></li><li><a class="tocitem" href="matrix_layouts.html">Matrix layouts</a></li><li><a class="tocitem" href="messages.html">Messages</a></li><li><a class="tocitem" href="unions.html">Unions</a></li><li><a class="tocitem" href="example_data.html">Example data</a></li><li><a class="tocitem" href="todo.html">TODO</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="adapters.html">Adapters</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="adapters.html">Adapters</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tanaylab/Daf.jl/blob/main{path}?plain=1#L{line}" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tanaylab/Daf.jl/blob/main/src/adapters.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Adapters"><a class="docs-heading-anchor" href="#Adapters">Adapters</a><a id="Adapters-1"></a><a class="docs-heading-anchor-permalink" href="#Adapters" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Daf.Adapters" href="#Daf.Adapters"><code>Daf.Adapters</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Adapt <code>daf</code> data to a <a href="computations.html#Daf.Computations.@computation"><code>@computation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tanaylab/Daf.jl/blob/d5e3356ee93b32fe48b2b484055bf703d026ee8d/src/adapters.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Daf.Adapters.adapter" href="#Daf.Adapters.adapter"><code>Daf.Adapters.adapter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">adapter(
    computation::Function,
    name::AbstractString,
    view::Union{DafView, ReadOnlyView};
    [capture=MemoryDaf,
    axes::AbstractVector{Pair{String, AxesValue}} = Vector{Pair{String, String}}(),
    data::AbstractVector{Pair{DataKey, DataValue}} = Vector{Pair{String, String}}(),
    empty::Maybe{Dict{EmptyKey, EmptyValue}} = nothing,
    relayout::Bool = true,
    overwrite::Bool = false]
)::Any where {
    DataKey &lt;: Union{
        String,                        # Scalar name
        Tuple{String, String},         # Axis, vector name
        Tuple{String, String, String}  # Rows axis, columns axis, matrix name
    },
    DataValue &lt;: Maybe{Union{AbstractString, Query}},
    AxesValue &lt;: Maybe{Union{AbstractString, Query}},
    EmptyKey &lt;: Union{
        Tuple{AbstractString, AbstractString},                  # Key for empty value for vectors.
        Tuple{AbstractString, AbstractString, AbstractString},  # Key for empty value for matrices.
    },
    EmptyValue &lt;: StorageScalarBase
}</code></pre><p>Invoke a computation on a <code>view</code> data set and return the result; copy a <a href="views.html#Daf.Views.viewer"><code>viewer</code></a> of the updated data set into the base <code>daf</code> data of the view.</p><p>If you have some <code>daf</code> data you wish to run a computation on, you need to deal with name mismatches. That is, the names of the input and output data properties of the computation may be different from these used in your data. In addition, you might be interested only in a subset of the computed data properties, to avoiding polluting your data set with irrelevant properties.</p><p>To address these issues, the common idiom for applying computations to <code>daf</code> data is to use the <code>adapter</code> as follows:</p><ul><li>Create a (read-only) <code>view</code> of your data which presents the data properties under the names expected by the computation, using <a href="views.html#Daf.Views.viewer"><code>viewer</code></a>. If the computation was annotated by <code>@computation</code>, then its <a href="contracts.html#Daf.Contracts.Contract"><code>Contract</code></a> will be explicitly documented so you will know exactly what to provide.</li><li>Pass this <code>view</code> to <code>adapter</code>, which will invoke the <code>computation</code> with a (writable) <code>adapted</code> version of the data (created using <a href="chains.html#Daf.Chains.chain_writer"><code>chain_writer</code></a> and a new <code>DafWriter</code> to <code>capture</code> the output; by default, this will be a [<code>MemoryDaf</code>]@(ref)).</li><li>Once the computation is done, create a new view of the output, which presents the subset of the output data properties you are interested in, with the names you would like to store them as. Again, if the computation was annotated by <a href="computations.html#Daf.Computations.@computation"><code>@computation</code></a>, then its <a href="contracts.html#Daf.Contracts.Contract"><code>Contract</code></a> will be explicitly documented so you will know exactly what to expect.</li><li>Copy this output view data into the base <code>daf</code> data of the <code>view</code> (using <a href="copies.html#Daf.Copies.copy_all!"><code>copy_all!</code></a>, <code>empty</code>, <code>relayout</code> (default: <code>true</code>) and <code>overwrite</code> (default: <code>false</code>).</li></ul><p>That is, the code would look something like this:</p><pre><code class="nohighlight hljs">daf = ... # Some input `daf` data we wish to compute on.

# Here `daf` contains the inputs for the computation, but possibly
# under a different name.

result = adapter(
    &quot;example&quot;,              # A name to use to generate the temporary `daf` data names.
    view(daf; ...),         # How to view the input in the way expected by the computation.
    axes = ..., data = ..., # How and what to view the output for copying back into `daf`.
    empty = ...,            # If the view specifies a subset of some axes.
) do adapted                   # The writable adapted data we can pass to the computation.
    computation(adapted, ...)  # Actually do the computation.
    return ...                 # An additional result outside `daf`.
end

# Here `daf` will contain the specific renamed outputs specified in `adapter`,
# and you can also access the additional non-`daf` data `result`.</code></pre><p>This idiom allows <a href="computations.html#Daf.Computations.@computation"><code>@computation</code></a> functions to use clear generic names for their inputs and outputs, and still apply them to arbitrary data sets using more specific names. One can even invoke the same computation with different parameter values, and store the different results in the same data set under different names.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tanaylab/Daf.jl/blob/d5e3356ee93b32fe48b2b484055bf703d026ee8d/src/adapters.jl#L18-L92">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="copies.html">« Copies</a><a class="docs-footer-nextpage" href="contracts.html">Contracts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
